!function(t,e){function o(t){for(var e=t.offsetLeft,o=t.offsetParent;null!==o;)e+=o.offsetLeft,o=o.offsetParent;return e}function n(t){for(var e=t.offsetTop,o=t.offsetParent;null!==o;)e+=o.offsetTop,o=o.offsetParent;return e}var i="ontouchstart"in document,r=i?t.EVENT_START:"mousedown",a=i?t.EVENT_MOVE:"mousemove",l=i?t.EVENT_END:"mouseup",s=t.className("locker-holder"),c=t.className("locker"),h=e.querySelector("head")||e.querySelector("body");h.innerHTML+="<style>.mui-locker-holder{overflow:hidden;position:relative;padding:0px;}.mui-locker-holder canvas{width:100%;height:100%;}</style>";var f=2,d=t.Locker=t.Class.extend({R:26,CW:400,CH:320,OffsetX:30,OffsetY:30,init:function(e,o){var n=this;if(!e)throw"构造 Locker 时缺少容器元素";n.holder=e,o=o||{},o.callback=o.callback||o.done||t.noop,o.times=o.times||f,n.options=o,n.holder.innerHTML="<canvas></canvas>",n.holder.classList.add(s);var i=n.canvas=t.qsa("canvas",n.holder)[0];i.on=i.addEventListener||function(t,e,o){i.attachEvent("on"+t,e,o)},i.off=i.removeEventListener||function(t,e,o){i.detachEvent("on"+t,e,o)},n.options.width&&(n.holder.style.width=n.options.width+"px"),n.options.height&&(n.holder.style.height=n.options.height+"px"),n.CW=n.options.width||n.holder.offsetWidth||n.CW,n.CH=n.options.height||n.holder.offsetHeight||n.CH,n.R*=n.options.times,n.CW*=n.options.times,n.CH*=n.options.times,n.OffsetX*=n.options.times,n.OffsetY*=n.options.times,i.width=n.CW,i.height=n.CH;var r=n.cxt=i.getContext("2d"),a=(n.CW-2*n.OffsetX-2*n.R*3)/2,l=(n.CH-2*n.OffsetY-2*n.R*3)/2;n.pointLocationArr=n.caculateNinePointLotion(a,l),n.initEvent(i,r,n.holder),n.draw(r,n.pointLocationArr,[],null),setTimeout(function(){n.draw(r,n.pointLocationArr,[],null)},0)},caculateNinePointLotion:function(t,e){for(var o=this,n=[],i=0;i<3;i++)for(var r=0;r<3;r++){var a={X:o.OffsetX+r*t+(2*r+1)*o.R,Y:o.OffsetY+i*e+(2*i+1)*o.R};n.push(a)}return n},draw:function(t,e,o,n){var i=this,r=i.R;if(o.length>0){t.beginPath();for(var a=0;a<o.length;a++){var l=o[a];t.lineTo(e[l].X,e[l].Y)}if(t.lineWidth=(i.options.lindeWidth||2)*i.options.times,t.strokeStyle=i.options.lineColor||"#999",t.stroke(),t.closePath(),null!=n){var s=o[o.length-1],c=e[s];t.beginPath(),t.moveTo(c.X,c.Y),t.lineTo(n.X,n.Y),t.stroke(),t.closePath()}}for(var a=0;a<e.length;a++){var h=e[a];t.fillStyle=i.options.ringColor||"#888",t.beginPath(),t.arc(h.X,h.Y,r,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle=i.options.fillColor||"#f3f3f3",t.beginPath(),t.arc(h.X,h.Y,r-(i.options.ringWidth||2)*i.options.times,0,2*Math.PI,!0),t.closePath(),t.fill(),o.indexOf(a)>=0&&(t.fillStyle=i.options.pointColor||"#777",t.beginPath(),t.arc(h.X,h.Y,r-(i.options.pointWidth||16)*i.options.times,0,2*Math.PI,!0),t.closePath(),t.fill())}},isPointSelect:function(t,e){for(var o=this,n=0;n<o.pointLocationArr.length;n++){var i=o.pointLocationArr[n],r=Math.abs(i.X-t.elementX),a=Math.abs(i.Y-t.elementY),l=Math.pow(r*r+a*a,.5);if(l<o.R){e.indexOf(n)<0&&e.push(n);break}}},initEvent:function(e,i,s){var c=this,h=[],f=!1;c._startHandler=function(t){t.point=event.changedTouches?event.changedTouches[0]:event,t.point.elementX=(t.point.pageX-o(s))*c.options.times,t.point.elementY=(t.point.pageY-n(s))*c.options.times,c.isPointSelect(t.point,h),f=!0},e.on(r,c._startHandler,!1),c._moveHanlder=function(t){if(f){t.preventDefault(),t.point=event.changedTouches?event.changedTouches[0]:event,t.point.elementX=(t.point.pageX-o(s))*c.options.times,t.point.elementY=(t.point.pageY-n(s))*c.options.times;var e=t.point;c.isPointSelect(e,h),i.clearRect(0,0,c.CW,c.CH),c.draw(i,c.pointLocationArr,h,{X:e.elementX,Y:e.elementY})}},e.on(a,c._moveHanlder,!1),c._endHandler=function(e){e.point=event.changedTouches?event.changedTouches[0]:event,e.point.elementX=(e.point.pageX-o(s))*c.options.times,e.point.elementY=(e.point.pageY-n(s))*c.options.times,i.clearRect(0,0,c.CW,c.CH),c.draw(i,c.pointLocationArr,h,null);var r={sender:c,points:h};c.options.callback(r),t.trigger(c.holder,"done",r),h=[],f=!1},e.on(l,c._endHandler,!1)},pointLocationArr:[],clear:function(){var t=this;t.cxt&&(t.cxt.clearRect(0,0,t.CW,t.CH),t.draw(t.cxt,t.pointLocationArr,[],{X:0,Y:0}))},dispose:function(){var t=this;t.cxt=null,t.canvas.off(r,t._startHandler),t.canvas.off(a,t._moveHandler),t.canvas.off(l,t._endHandler),t.holder.innerHTML="",t.canvas=null}});t.fn.locker=function(t){return this.each(function(e,o){if(!o.locker)if(t)o.locker=new d(o,t);else{var n=o.getAttribute("data-locker-options"),i=n?JSON.parse(n):{};i.lineColor=o.getAttribute("data-locker-line-color")||i.lineColor,i.ringColor=o.getAttribute("data-locker-ring-color")||i.ringColor,i.fillColor=o.getAttribute("data-locker-fill-color")||i.fillColor,i.pointColor=o.getAttribute("data-locker-point-color")||i.pointColor,i.width=o.getAttribute("data-locker-width")||i.width,i.height=o.getAttribute("data-locker-height")||i.height,o.locker=new d(o,i)}}),this[0]?this[0].locker:null};try{t("."+c).locker()}catch(t){}t.ready(function(){t("."+c).locker()})}(mui,document);