function getRandomHost(){var e=["https://apibj.beecloud.cn","https://apihz.beecloud.cn","https://apisz.beecloud.cn","https://apiqd.beecloud.cn"];return""+e[parseInt(3*Math.random())]+"/2/rest/app/bill"}function getPayChannel(e){var n="";switch(e){case"ALI_APP":n="alipay";break;case"WX_APP":n="wxpay"}for(var a in channels)if(channels[a].id==n)return channels[a];return null}function doPay(e,n,a){w||(w=plus.nativeUI.showWaiting(),mui.ajax(getRandomHost(),{data:JSON.stringify(e),type:"post",dataType:"json",contentType:"application/json",success:function(t){w.close(),w=null;var i="";if(0==t.result_code){var s=getPayChannel(e.channel);if(s){if("alipay"===s.id)i=t.order_string;else if("wxpay"===s.id){var l={};l.appid=t.app_id,l.noncestr=t.nonce_str,l.package=t.package,l.partnerid=t.partner_id,l.prepayid=t.prepay_id,l.timestamp=parseInt(t.timestamp),l.sign=t.pay_sign,i=JSON.stringify(l)}plus.payment.request(s,i,n,a)}else if("UN_WEB"==e.channel){var o=plus.webview.create("","beecloudPay");o.setJsFile("_www/js/95516.js"),o.addEventListener("loaded",function(){o.isVisible()||o.show()}),o.loadData(t.html)}}else{var r={};r.code=t.result_code,r.message=t.result_msg+":"+t.err_detail,a(r)}},error:function(e,n,t){w.close(),w=null,a(t)}}))}var beecloud={},channels=null,w=null;beecloud.payReq=function(e,n,a){doPay(e,n,a)},beecloud.genBillNo=function(){var e=new Date,n=e.getFullYear(),a=e.getMonth()+1,t=e.getDate(),i=e.getHours(),s=e.getMinutes(),l=e.getSeconds(),o=e.getMilliseconds();return billno=""+n+(a<10?"0"+a:a)+(t<10?"0"+t:t)+(i<10?"0"+i:i)+(s<10?"0"+s:s)+(l<10?"0"+l:l)+o,billno},mui.plusReady(function(){var e=["alipay","wxpay"];plus.payment.getChannels(function(n){for(var a=document.querySelector(".oauth-area"),t=0;t<n.length;t++)if(n[t].serviceReady&&~e.indexOf(n[t].id)){var i=document.createElement("div");i.setAttribute("id",n[t].id),i.className="mui-btn mui-btn-blue mui-btn-block pay",i.innerText=n[t].description+"支付",a.appendChild(i)}channels=n},function(e){console.log("获取支付渠道信权限失败:"+e.message)})});