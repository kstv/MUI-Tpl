!function(t,e){t.dom=function(i){return"string"!=typeof i?i instanceof Array||i[0]&&i.length?[].slice.call(i):[i]:(t.__create_dom_div__||(t.__create_dom_div__=e.createElement("div")),t.__create_dom_div__.innerHTML=i,[].slice.call(t.__create_dom_div__.childNodes))};var i='<div class="mui-dtpicker" data-type="datetime">\t\t<div class="mui-dtpicker-header">\t\t\t<button data-id="btn-cancel" class="mui-btn">取消</button>\t\t\t<button data-id="btn-ok" class="mui-btn mui-btn-blue">确定</button>\t\t</div>\t\t<div class="mui-dtpicker-title"><h5 data-id="title-y">年</h5><h5 data-id="title-m">月</h5><h5 data-id="title-d">日</h5><h5 data-id="title-h">时</h5><h5 data-id="title-i">分</h5></div>\t\t<div class="mui-dtpicker-body">\t\t\t<div data-id="picker-y" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-m" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-d" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-h" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t\t<div data-id="picker-i" class="mui-picker">\t\t\t\t<div class="mui-picker-inner">\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-ft"></div>\t\t\t\t\t<ul class="mui-pciker-list">\t\t\t\t\t</ul>\t\t\t\t\t<div class="mui-pciker-rule mui-pciker-rule-bg"></div>\t\t\t\t</div>\t\t\t</div>\t\t</div>\t</div>';t.DtPicker=t.Class.extend({init:function(a){var n=this,s=t.dom(i)[0];e.body.appendChild(s),t('[data-id*="picker"]',s).picker();var r=n.ui={picker:s,mask:t.createMask(),ok:t('[data-id="btn-ok"]',s)[0],cancel:t('[data-id="btn-cancel"]',s)[0],y:t('[data-id="picker-y"]',s)[0],m:t('[data-id="picker-m"]',s)[0],d:t('[data-id="picker-d"]',s)[0],h:t('[data-id="picker-h"]',s)[0],i:t('[data-id="picker-i"]',s)[0],labels:t('[data-id*="title-"]',s)};r.cancel.addEventListener("tap",function(){n.hide()},!1),r.ok.addEventListener("tap",function(){var t=n.callback(n.getSelected());t!==!1&&n.hide()},!1),r.y.addEventListener("change",function(t){n.options.beginMonth||n.options.endMonth?n._createMonth():n._createDay()},!1),r.m.addEventListener("change",function(t){n._createDay()},!1),r.d.addEventListener("change",function(t){(n.options.beginMonth||n.options.endMonth)&&n._createHours()},!1),r.h.addEventListener("change",function(t){(n.options.beginMonth||n.options.endMonth)&&n._createMinutes()},!1),r.mask[0].addEventListener("tap",function(){n.hide()},!1),n._create(a),n.ui.picker.addEventListener(t.EVENT_START,function(t){t.preventDefault()},!1),n.ui.picker.addEventListener(t.EVENT_MOVE,function(t){t.preventDefault()},!1)},getSelected:function(){var t=this,e=t.ui,i=t.options.type,a={type:i,y:e.y.picker.getSelectedItem(),m:e.m.picker.getSelectedItem(),d:e.d.picker.getSelectedItem(),h:e.h.picker.getSelectedItem(),i:e.i.picker.getSelectedItem(),toString:function(){return this.value}};switch(i){case"datetime":a.value=a.y.value+"-"+a.m.value+"-"+a.d.value+" "+a.h.value+":"+a.i.value,a.text=a.y.text+"-"+a.m.text+"-"+a.d.text+" "+a.h.text+":"+a.i.text;break;case"date":a.value=a.y.value+"-"+a.m.value+"-"+a.d.value,a.text=a.y.text+"-"+a.m.text+"-"+a.d.text;break;case"time":a.value=a.h.value+":"+a.i.value,a.text=a.h.text+":"+a.i.text;break;case"month":a.value=a.y.value+"-"+a.m.value,a.text=a.y.text+"-"+a.m.text;break;case"hour":a.value=a.y.value+"-"+a.m.value+"-"+a.d.value+" "+a.h.value,a.text=a.y.text+"-"+a.m.text+"-"+a.d.text+" "+a.h.text}return a},setSelectedValue:function(t){var e=this,i=e.ui,a=e._parseValue(t);i.y.picker.setSelectedValue(a.y,0,function(){i.m.picker.setSelectedValue(a.m,0,function(){i.d.picker.setSelectedValue(a.d,0,function(){i.h.picker.setSelectedValue(a.h,0,function(){i.i.picker.setSelectedValue(a.i,0)})})})})},isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},_inArray:function(t,e){for(var i in t){var a=t[i];if(a===e)return!0}return!1},getDayNum:function(t,e){var i=this;return i._inArray([1,3,5,7,8,10,12],e)?31:i._inArray([4,6,9,11],e)?30:i.isLeapYear(t)?29:28},_fill:function(t){return t=t.toString(),t.length<2&&(t=0+t),t},_isBeginYear:function(){return this.options.beginYear===parseInt(this.ui.y.picker.getSelectedValue())},_isBeginMonth:function(){return this.options.beginMonth&&this._isBeginYear()&&this.options.beginMonth===parseInt(this.ui.m.picker.getSelectedValue())},_isBeginDay:function(){return this._isBeginMonth()&&this.options.beginDay===parseInt(this.ui.d.picker.getSelectedValue())},_isBeginHours:function(){return this._isBeginDay()&&this.options.beginHours===parseInt(this.ui.h.picker.getSelectedValue())},_isEndYear:function(){return this.options.endYear===parseInt(this.ui.y.picker.getSelectedValue())},_isEndMonth:function(){return this.options.endMonth&&this._isEndYear()&&this.options.endMonth===parseInt(this.ui.m.picker.getSelectedValue())},_isEndDay:function(){return this._isEndMonth()&&this.options.endDay===parseInt(this.ui.d.picker.getSelectedValue())},_isEndHours:function(){return this._isEndDay()&&this.options.endHours===parseInt(this.ui.h.picker.getSelectedValue())},_createYear:function(t){var e=this,i=e.options,a=e.ui,n=[];if(i.customData.y)n=i.customData.y;else for(var s=i.beginYear,r=i.endYear,u=s;u<=r;u++)n.push({text:u+"",value:u});a.y.picker.setItems(n)},_createMonth:function(t){var e=this,i=e.options,a=e.ui,n=[];if(i.customData.m)n=i.customData.m;else for(var s=i.beginMonth&&e._isBeginYear()?i.beginMonth:1,r=i.endMonth&&e._isEndYear()?i.endMonth:12;s<=r;s++){var u=e._fill(s);n.push({text:u,value:u})}a.m.picker.setItems(n)},_createDay:function(t){var e=this,i=e.options,a=e.ui,n=[];if(i.customData.d)n=i.customData.d;else for(var s=e._isBeginMonth()?i.beginDay:1,r=e._isEndMonth()?i.endDay:e.getDayNum(parseInt(this.ui.y.picker.getSelectedValue()),parseInt(this.ui.m.picker.getSelectedValue()));s<=r;s++){var u=e._fill(s);n.push({text:u,value:u})}a.d.picker.setItems(n),t=t||a.d.picker.getSelectedValue()},_createHours:function(t){var e=this,i=e.options,a=e.ui,n=[];if(i.customData.h)n=i.customData.h;else for(var s=e._isBeginDay()?i.beginHours:0,r=e._isEndDay()?i.endHours:23;s<=r;s++){var u=e._fill(s);n.push({text:u,value:u})}a.h.picker.setItems(n)},_createMinutes:function(t){var e=this,i=e.options,a=e.ui,n=[];if(i.customData.i)n=i.customData.i;else for(var s=e._isBeginHours()?i.beginMinutes:0,r=e._isEndHours()?i.endMinutes:59;s<=r;s++){var u=e._fill(s);n.push({text:u,value:u})}a.i.picker.setItems(n)},_setLabels:function(){var t=this,e=t.options,i=t.ui;i.labels.each(function(t,i){i.innerText=e.labels[t]})},_setButtons:function(){var t=this,e=t.options,i=t.ui;i.cancel.innerText=e.buttons[0],i.ok.innerText=e.buttons[1]},_parseValue:function(t){var e={};if(t){var i=t.replace(":","-").replace(" ","-").split("-");e.y=i[0],e.m=i[1],e.d=i[2],e.h=i[3],e.i=i[4]}else{var a=new Date;e.y=a.getFullYear(),e.m=a.getMonth()+1,e.d=a.getDate(),e.h=a.getHours(),e.i=a.getMinutes()}return e},_create:function(t){var e=this;t=t||{},t.labels=t.labels||["年","月","日","时","分"],t.buttons=t.buttons||["取消","确定"],t.type=t.type||"datetime",t.customData=t.customData||{},e.options=t;var i=new Date,a=t.beginDate;a instanceof Date&&!isNaN(a.valueOf())&&(t.beginYear=a.getFullYear(),t.beginMonth=a.getMonth()+1,t.beginDay=a.getDate(),t.beginHours=a.getHours(),t.beginMinutes=a.getMinutes());var n=t.endDate;n instanceof Date&&!isNaN(n.valueOf())&&(t.endYear=n.getFullYear(),t.endMonth=n.getMonth()+1,t.endDay=n.getDate(),t.endHours=n.getHours(),t.endMinutes=n.getMinutes()),t.beginYear=t.beginYear||i.getFullYear()-5,t.endYear=t.endYear||i.getFullYear()+5;var s=e.ui;e._setLabels(),e._setButtons(),s.picker.setAttribute("data-type",t.type),e._createYear(),e._createMonth(),e._createDay(),e._createHours(),e._createMinutes(),e.setSelectedValue(t.value)},show:function(i){var a=this,n=a.ui;a.callback=i||t.noop,n.mask.show(),e.body.classList.add(t.className("dtpicker-active-for-page")),n.picker.classList.add(t.className("active")),a.__back=t.back,t.back=function(){a.hide()}},hide:function(){var i=this;if(!i.disposed){var a=i.ui;a.picker.classList.remove(t.className("active")),a.mask.close(),e.body.classList.remove(t.className("dtpicker-active-for-page")),t.back=i.__back}},dispose:function(){var t=this;t.hide(),setTimeout(function(){t.ui.picker.parentNode.removeChild(t.ui.picker);for(var e in t)t[e]=null,delete t[e];t.disposed=!0},300)}})}(mui,document);